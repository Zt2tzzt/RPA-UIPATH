# 实战篇-网页抓取

应用场景：你是一家公司的数据分析师，负责监控与其行业相关的新闻。你要经常从各种网站抓取相关新闻文章，以便分析最新的行业趋势。

简化需求：用 RPA 从百度搜索抓取

步骤分析：

1. 登录百度搜索网站。
2. 在搜索框内输入关键词。
3. 点击”百度一下“
4. 点击”资讯“
5. 创建一个 Excel 文档。
6. 读取网页上的标题、URL链接、摘要、新闻来源，并保存到 Excel 文档。
7. 重复上一步，读取和保存前 50 条资讯。
8. 保存 Excel 文档。

打开 UiPath。

新建一个流程 `实战篇1 网页抓取`

在序列中，添加一个活动，“使用应用程序-浏览器”。

- 在 chrome 浏览器中，安装 UiPath 扩展插件；
- 添加 chrome 浏览器中百度的页面

在执行中，添加一个活动，”输入信息“

- 添加百度的搜索框进来。
- 将”输入此项“设置为：`"区块链"`

在执行中，添加一个活动，“键盘快捷方式：

- 在记录快捷方式中，输入回车。

在执行中，添加一个活动，”单击“

- 在”此应用程序中指定“中，选择 chrome 标签页上的 ”资讯“
- 除此之外，还要添加一个锚点，用于网页更新后，正确找到元素。这里的锚点选择搜索框。

在 UiPath Studio 上方，选取”表格数据提取“

- 点击”选择提取的数据源“，选择 chrome 中百度页面上的搜索结果标题。并把该列命名为”标题“
- 依此类推，新增”URL链接“，”摘要“，”新闻来源“三列。
- 打开”从多个页面提取数据“按钮，指定浏览器页面上的”下一步“按钮。
- 再点击上方设置按钮，设置提取内容限制：最大行数 50 行。
- 最后点击保存并关闭。

可以看到，UiPath 将提取到的数据，保存在了 ExtractDataTable 变量中。它的类型为 DataTable，即多行多列的数据。

在执行下方，添加一个活动，”写入范围 workbook“

- 工作牌路径设置为：`"百度区块链资讯.xlsx"`；
- 工作表名称设置为：`sheet1`；
- 数据表设置为：ExtractDataTable  变量。
- 勾选右侧属性的“添加标头”