# 实战篇-群发微信消息

## 一、需求分析

应用场景：你是一位销售人员，你定期要给在微信上的客户群发消息。你希望给每个客户的信息开始的称呼是不一样的。

步骤分析：

1. 读取 Excel 文档里的客户信息。
2. 找到客户对应的微信对话框，编几个性化消息，发送。

知识点：

- 单击。
- 输入信息。
- 使用 Excel 文件。
- 对每个 Excel 行循环。
- 读取文本文件。

高级功能 - 消息模板

1. 从记事本（Notepod）里，读取消息模板。
2. 把个性化信息加进去。
3. 发送信息。

## 二、案例实践

打开 UiPath

创建一个新的流程 `实战篇4 群发微信消息`

在序列中，添加一个活动"使用应用程序/浏览器"

- 选择微信的界面。

在执行中，添加一个活动“输入信息”

- 选择微信左上角的搜索框。
- 输入此项设置为：`"瑞幸首席福利官"`

在执行中，添加一个活动“键盘快捷方式”

- 记录快捷方式设置为：输入一个回车键

在执行中，添加一个活动“输入信息”

- 选择微信下方的输入框。
- 输入此项设置为：`"瑞先生，您好！现在向你推荐一款我们公司的产品！"`
- 在输入前清空字段，选择“多行”

在执行中，添加一个活动“单击”

- 选择微信下方的”发送“按钮。

---

在项目根目录下，创建 data/names.xlsx

在其中，维护微信名和称呼两列。

---

在 Main Sequence 的最上方，加入一个活动”使用 Excel 文件“

- Excel 文件，设置为：`data/names.xlsx`

在执行中，加入一个活动”对每个 Excel 行“

- 在范围内，设置为：`Excel.Sheet("Sheet1")`
- 勾选”含标头“

在执行中，加入一个活动”日志消息“

- 消息，设置为：`CurrentRow("微信名") + " " + CurrentRow("称呼")`

禁用下方的发送信息活动，然后运行项目测试，查看输出的值。

---

下方的发送信息活动，拖入“对每个 Excel 行”的执行中。

修改两处“输入消息”

运行项目，看是否发送成功。

---

## 三、优化

在 data 目录下，新建 模板.txt

- 在其中，放入文本：`，您好！现在向你推荐一款我们公司的产品！`

在 Main Seqence 的最上方，加入一个活动“读取文本文件”

- 文件名，设置为：`"data\模板.txt"`
- 在右侧属性栏中，设置输出位置：一个新的变量 `Template`

修改下方的输入消息，加入 Template 变量。

---

在 Main Sequence 的“读取文本文件”活动下方，加入一个“Excel 流程作用域”

将 Excel 相关流程，拖入到其中。
