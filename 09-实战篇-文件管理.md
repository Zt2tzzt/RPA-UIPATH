# 实战篇-文件管理

# 一、需求分析

应用场景：你是一位自由摄影师，经常在活动中，拍摄数百张照片。这些照片，堆积在一个文件夹里，你想要手动分类，但是做起来很繁琐。

解决方案：使用 UiPath RPA 根据事件、日期、客户，自动对照片进行分类和组织，以便在需要时找到并访问特定照片。

前提条件：照片命名必须按照固定规范，比如：“事件名称\_日期\_ 编号”

步骤分析：

1. 读取文件夹里的所有照片文件。
2. 从文件名里面截取事件名称和日期。
3. 按照事件名称，建立新的文件夹。
4. 在每个文件夹里面，建立日期子文件夹。
5. 把照片按照事件名称和日期，移到对应的文件夹里面。

## 二、案例时间

打开 UiPath

创建一个新的流程 `实战篇3 文件管理`

在项目根目录，创建一个新文件夹 data，在其中，添加一些照片。

在序列中，添加一个分配，或搜索关键词“assign”

- 要保存的值，设置为：`Directory.GetFiles("data")`；
- 保存位置，设置为一个新的变量：`Photos`，将类型设置为 Array of String

> 注意：获取目录下，文件路径的方法 `Directory.GetFiles("[目录]")`

---

在序列中，加入一个活动“循环遍历”

- 项目列表设置为：`Photos`
- 项目设置为：`Photo`

在 Body 中，加入一个“日志消息”

- 消息设置为：`Photo`

运行项目，查看获取到的照片的路径，比如：`data\室外聚会 2021-04-09-192366.png`。

---

在 Body 中，加入一个“分配”，或搜索关键词“assgin”

- 要保存的值，设置为：`Path.GetFileName(Photo)`
- 要保存的位置，设置为一个新的变量：`Name`

> 注意：获取文件路径中，文件名的方法：`Path.GetFileName("[文件路径]")`

在 Body 中，加入一个“日志消息”

- 消息设置为：`Name`

运行项目，查看获取到的照片文件名，比如：`室外聚会 2021-04-09-192366.png`。

> 加入“日志消息”，是一个非常好的习惯。一边设计，一边调试。

---

在 Body 中，加入一个“分配”，或搜索关键词“assgin”

- 要保存的值，设置为：`Name.Split(" ")(0)`
- 要保存的位置，设置为一个新的变量：`EventName`

> 注意：分割字符串的方法：`String.Split("[分隔符]")`

在 Body 中，加入一个“分配”，或搜索关键词“assgin”

- 要保存的值，设置为：`Name.Split(" ")(1)`
- 要保存的位置，设置为一个新的变量：`EventDate`

在 Body 中，加入一个“分配”，或搜索关键词“assgin”

- 要保存的值，设置为：`EventDate.Split("-")(0)`
- 要保存的位置，设置为一个新的变量：`Year`

在 Body 中，加入一个“日志消息”

- 消息设置为：`EventName + " " + Year`

运行项目，查看获取到的事件名称和年份。

---

在 Body 中，加入一个“分配”，或搜索关键词“assgin”

- 要保存的值，设置为：`Path.Combine("data2", EventName, Year)`
- 要保存的位置，设置为一个新的变量：`NewPath`

> 注意：生成路径的方法：`Path.Combine("[文件夹名]", "[文件夹名]", ...)`

在 Body 中，加入一个“创建文件夹”

- 文件夹名称，设置为：`NewPath`

在 Body 中，加入一个“移动文件”

- 来源文件夹，设置为：`Photo`

运行项目，刷新项目资源管理栏，查看 data2 文件夹。
